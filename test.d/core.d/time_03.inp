
* chop (t a b) 
	(as 
		l (leng (t))
		(tail (head (t) (b)) (sub (b) (a)))
	)
* repl (t r x) 
	(do 
		(ptrn (r))
		(mtch (t))
		(as
			a (msta)
			b (mend)
			l (leng (t))
			(join (chop (t) 0.0 (a)) (join (x) (chop (t) (b) (leng (t)))))
		)
	)
* bare (n) 
	(repl (repl (text (n)) "\\.[0-9]+" "") "^[-+]" "")

* dt_mod (old dif) 
	(info (repr (old)) (if (pos (dif)) " plus " " minus ")  (bare (dif)) "s/" (bare (div (dif) +3600.0)) "h/" (bare (div (dif) (mul +24.0 +3600.0))) "d = " (repr (add (old) (dif))))

* n_days (n) 
	(mul (mul +3600.0 +24.0) (n))
* n_hours (n) 
	(mul +3600.0 (n))

(info)
(dt_mod (pars "2011-03-23 15:01:03") (n_days +1.0))
(dt_mod (pars "2011-03-23 15:01:03") (n_days +2.0))
(dt_mod (pars "2011-03-23 15:01:03") (n_days +3.0))
(dt_mod (pars "2011-03-23 15:01:03") (n_days -1.0))
(dt_mod (pars "2011-03-23 15:01:03") (n_days -2.0))
(dt_mod (pars "2011-03-23 15:01:03") (n_days -3.0))
(info)	
(dt_mod (pars "2011-03-23 15:01:03") (n_days +100.0))
(dt_mod (pars "2011-03-23 15:01:03") (n_days +200.0))
(dt_mod (pars "2011-03-23 15:01:03") (n_days +300.0))
(dt_mod (pars "2011-03-23 15:01:03") (n_days -100.0))
(dt_mod (pars "2011-03-23 15:01:03") (n_days -200.0))
(dt_mod (pars "2011-03-23 15:01:03") (n_days -300.0))
(info)
(dt_mod (pars "2011-03-23 15:01:03") (n_hours +1.0))
(dt_mod (pars "2011-03-23 15:01:03") (n_hours +2.0))
(dt_mod (pars "2011-03-23 15:01:03") (n_hours +3.0))
(dt_mod (pars "2011-03-23 15:01:03") (n_hours -1.0))
(dt_mod (pars "2011-03-23 15:01:03") (n_hours -2.0))
(dt_mod (pars "2011-03-23 15:01:03") (n_hours -3.0))
(info)	
(dt_mod (pars "2011-03-23 15:01:03") (n_hours +100.0))
(dt_mod (pars "2011-03-23 15:01:03") (n_hours +200.0))
(dt_mod (pars "2011-03-23 15:01:03") (n_hours +300.0))
(dt_mod (pars "2011-03-23 15:01:03") (n_hours -100.0))
(dt_mod (pars "2011-03-23 15:01:03") (n_hours -200.0))
(dt_mod (pars "2011-03-23 15:01:03") (n_hours -300.0))
	
	
